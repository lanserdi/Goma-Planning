!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).goma=t()}(this,function(){"use strict";function i(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return{Planning:function(){function t(e){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),"[object HTMLDivElement]"!==Object.prototype.toString.call(e.eleWrap))throw new Error("确保eleWrap参数类型为HTMLDivElement！");if(this._eleWrap=e.eleWrap,this._eleWrap.classList.add("goma-planing-scope"),"[object Array]"!==Object.prototype.toString.call(e.cardsProp)||e.cardsProp.length<1)throw new Error("确保cards参数为至少包含一个card对象的数组！");this._cardsProp=e.cardsProp,this._navBarColor=e.navBarColor||"#222",this._onSendTask=e.onSendTask.bind(this),this._init()}return function(e,t,a){t&&i(e.prototype,t),a&&i(e,a)}(t,[{key:"_init",value:function(){this._activeCardPropIndex=0,this._renderNavBar(),this._createTaskListWrap(),this._createAddTaskComponent(),this._renderTasks()}},{key:"_renderNavBar",value:function(){var a=this;if(this._eleWrap.querySelector(".navbar-wrap"))this._eleNavBarWrap.querySelectorAll(".tag-btn").forEach(function(e,t){if(a._activeCardPropIndex==t)return e.classList.add("active"),void(e.querySelector(".tag-name").style.color=a._cardsProp[a._activeCardPropIndex].activeColor);e.classList.remove("active"),e.querySelector(".tag-name").style.color=a._cardsProp[a._activeCardPropIndex].defaultColor}),this._eleWrap.style.backgroundColor=this._cardsProp[this._activeCardPropIndex].activeColor,this._eleNavBarWrap.querySelector(".navbar-pointer").style.left="".concat(this._singleNavWidth*this._activeCardPropIndex,"%"),this._eleNavBarWrap.querySelector(".navbar-pointer").style.color=this._cardsProp[this._activeCardPropIndex].activeColor;else{this._eleNavBarWrap=document.createElement("div"),this._eleNavBarWrap.classList.add("navbar-wrap"),this._eleWrap.appendChild(this._eleNavBarWrap),this._eleNavBarWrap.addEventListener("click",this._onMouseClickNavbar.bind(this),!1);var e="",t=this._cardsProp.length;this._singleNavWidth=(100/t).toFixed(2);for(var i=0;i<t;i++){var s=this._cardsProp[i];this._singleNavWidth;e+='<div data-type="btn" data-i="'.concat(i,'" class="tag-btn ').concat(this._activeCardPropIndex==i?"active":"",'" style="width:').concat(this._singleNavWidth,'%;">\n  <span class="tag-name" style="color:').concat(this._activeCardPropIndex==i?s.activeColor:s.defaultColor,'">').concat(s.title,"</span>\n</div>")}var n=this._activeCardPropIndex*this._singleNavWidth;e+='<div class="navbar-pointer" style="left:'.concat(n,"%;color:").concat(this._cardsProp[this._activeCardPropIndex].activeColor,";width:").concat(this._singleNavWidth,'%;"></div>'),this._eleNavBarWrap.innerHTML=e,this._eleNavBarWrap.style.backgroundColor=this._navBarColor,this._eleWrap.style.backgroundColor=this._cardsProp[this._activeCardPropIndex].activeColor}}},{key:"_onMouseClickNavbar",value:function(e){for(var t=e.target;t!=this._eleNavBarWrap;){if("btn"==t.dataset.type){this._activeCardPropIndex=+t.dataset.i,this._renderNavBar(),0!==this._activeCardPropIndex?this._eleAddTaskWrap.style.bottom="-40px":this._eleAddTaskWrap.style.bottom="",this._renderTasks();break}t=t.parentNode}}},{key:"_createTaskListWrap",value:function(){this._eleTaskListWrap=document.createElement("div"),this._eleTaskListWrap.classList.add("task-list-wrap"),this._eleWrap.appendChild(this._eleTaskListWrap),this._eleTaskListWrap.addEventListener("click",this._onClickTaskListWrap.bind(this),!1),this._eleTaskList=document.createElement("div"),this._eleTaskList.classList.add("task-list"),this._eleTaskListWrap.appendChild(this._eleTaskList)}},{key:"_renderTasks",value:function(){for(var e=this._cardsProp[this._activeCardPropIndex].tasks,t="",a=0;a<e.length;a++)t+=this._getTaskItemTemplate(e[a],a);this._eleTaskList.innerHTML=t}},{key:"_appendNewTask",value:function(e){var t=document.createElement("div");t.innerHTML=this._getTaskItemTemplate(e,0),this._eleTaskList.append(t),this._eleTaskInput.focus(),this._cardsProp[0].tasks.push(e)}},{key:"_getTaskItemTemplate",value:function(e,t){return'<div class="task-item-wrap" data-id="'.concat(e.id,'" style="animation-delay: ').concat(50*t,'ms"><div class="check-box" data-type="btn" data-task-id="').concat(e.id,'"></div><p class="title">').concat(e.title,"</p></div>")}},{key:"_onClickTaskListWrap",value:function(e){for(var t=e.target;t!==this._eleTaskListWrap;)t=t.parentNode}},{key:"_createAddTaskComponent",value:function(){var t=this;this._eleAddTaskWrap=document.createElement("div"),this._eleAddTaskWrap.classList.add("add-task-wrap"),this._eleWrap.appendChild(this._eleAddTaskWrap),this._eleAddTaskInputWrap=document.createElement("div"),this._eleAddTaskInputWrap.classList.add("add-task-input-wrap"),this._eleAddTaskWrap.appendChild(this._eleAddTaskInputWrap),this._eleTaskInput=document.createElement("input"),this._eleTaskInput.classList.add("add-task-input"),this._eleTaskInput.setAttribute("placeholder","创建新的计划"),this._eleAddTaskInputWrap.appendChild(this._eleTaskInput),this._eleTaskInput.focus(),this._eleTaskInput.addEventListener("keypress",function(e){13==e.keyCode&&t._onClickSendTaskBtn()}),this._eleSendTask=document.createElement("div"),this._eleSendTask.classList.add("send-task"),this._eleSendTask.style.color=this._cardsProp[0].activeColor,this._eleAddTaskInputWrap.appendChild(this._eleSendTask),this._eleSendTask.addEventListener("click",this._onClickSendTaskBtn.bind(this),!1)}},{key:"_onClickSendTaskBtn",value:function(){var e=this._eleTaskInput.value.trim();e&&(this._eleTaskInput.value="",this._onSendTask(e,this._appendNewTask.bind(this,{title:e})))}},{key:"_createLoadingComponent",value:function(){for(var e=document.createElement("div"),t="",a=["#f44336","#f9a825","#5abd5e","#29b6f6"],i=0;i<4;i++)t+='<span class="loading-dot" style="animation: loading-dot 870ms '.concat(100*i,"ms cubic-bezier(.21,.02,.78,.98) infinite; background-color: ").concat(a[i],"; margin-left: ").concat(14*(i-Math.ceil(2)),'px;"></span>');return e.classList.add("loading-wrap"),e.innerHTML=t,e}},{key:"_showLoading",value:function(){this._eleLoading=this._createLoadingComponent(),this._eleLoading.dataset.visibility="visible",this._eleWrap.appendChild(this._eleLoading)}},{key:"_destroyLoading",value:function(){var e=this;if(this._eleLoading){setTimeout(function(){e._eleLoading&&e._eleLoading.parentNode.removeChild(e._eleLoading),e._eleLoading=null},100);this._eleLoading.dataset.visibility="hidden"}}}]),t}()}});